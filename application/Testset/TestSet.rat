<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'Sans Serif'; font-size:15pt; font-weight:400; font-style:normal;">
<table style="-qt-table-type: root; margin-top:4px; margin-bottom:4px; margin-left:4px; margin-right:4px;">
<tr>
<td style="border: none;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;">//1. Find the names of the persons who work for company 'Amdocs' (company name=’Amdocs’).Relational algebra:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;">π<span style=" vertical-align:sub;"> person_name </span>(σ<span style=" vertical-align:sub;"> company_name = 'Amdocs' </span>(t1_works));</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;">//2. List the names of the persons who work for company ’Amdocs’ along with the cities they live in.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;">π<span style=" vertical-align:sub;"> person_name </span>(π<span style=" vertical-align:sub;"> emp_id,person_name </span>(σ<span style=" vertical-align:sub;"> company_name='Amdocs' </span>(t1_works)) ⋈ t1_lives );</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;">//3. Find the persons who work for company ’FBC’ with a salary of more than 4200. List the names of these persons along with the streets and cities where they live.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;">highsal ← π<span style=" vertical-align:sub;"> emp_id, person_name </span>(σ<span style=" vertical-align:sub;"> salary&gt;4200 and company_name = 'Amdocs' </span>(t1_works));</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;">highsal ⋈ t1_lives </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;">//4. Find the names of the persons who live and work in the same city.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;">work_city ← π<span style=" vertical-align:sub;"> emp_id,person_name,city </span>(t1_works ⋈ t1_located_in) ;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;">π<span style=" vertical-align:sub;"> person_name </span>(work_city ⋈ t1_lives )</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;">//5 Find the names of the persons who live in the same city and on the same street as their managers.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;">π<span style=" vertical-align:sub;"> person_name, city </span>(t1_works ⋈ ( t1_lives ⋈ π<span style=" vertical-align:sub;"> manger_id, t1_managers.emp_id, city </span>(t1_managers ⋈<span style=" vertical-align:sub;"> manger_id= t1_lives.emp_id </span>t1_lives ) ) )</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;">//Above line does not work...looks like a bug as the subquery as given below works just fine. The above query gives ambiguous column error whereas there is no such error and it looks like an issue in passing conditions to inner queries.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;">( t1_lives ⋈ π<span style=" vertical-align:sub;"> manger_id, t1_managers.emp_id, city </span>(t1_managers ⋈<span style=" vertical-align:sub;"> manger_id= t1_lives.emp_id </span>t1_lives ) )</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;"></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;">// 6. Find the names of the persons who do not work for company ’FBC’.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;">π<span style=" vertical-align:sub;"> person_name </span>(π<span style=" vertical-align:sub;"> emp_id,person_name </span>(t1_works) − π<span style=" vertical-align:sub;"> emp_id,person_name </span>(σ<span style=" vertical-align:sub;"> company_name = 'Amdocs' </span>(t1_works) ))</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;">//7. Find the persons whose salaries are more than the salary of everybody who work for company ’SBC’.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;">A ←  π<span style=" vertical-align:sub;"> emp_id, person_name, salary </span>(σ<span style=" vertical-align:sub;"> company_name = 'Amdocs' </span>(t1_works));</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;">B ←  π<span style=" vertical-align:sub;"> emp_id,person_name,salary </span>(σ<span style=" vertical-align:sub;"> company_name &lt;&gt; 'Amdocs' </span>(t1_works));</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;">π<span style=" vertical-align:sub;"> emp_id,person_name </span>(B) − π<span style=" vertical-align:sub;"> B.emp_id, B.person_name </span>(B ⋈<span style=" vertical-align:sub;">  B.salary &lt; A.salary </span>A ) </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;"></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; -qt-user-state:0;"></p></td></tr></table></body></html>